<UserControl x:Class="U148.Uwp.Views.MainView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:behaviors="using:Microsoft.Toolkit.Uwp.UI.Animations.Behaviors"
             xmlns:converters="using:U148.Uwp.Converters"
             xmlns:core="using:Microsoft.Xaml.Interactions.Core"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:fontAwesome="using:SoftwareKobo.Icons.FontAwesome"
             xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
             xmlns:localControls="using:U148.Uwp.Controls"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="using:U148.Models"
             xmlns:views="using:U148.Uwp.Views"
             DataContext="{Binding Source={StaticResource Locator}, Path=Main}"
             Loaded="MainView_Loaded"
             Unloaded="MainView_Unloaded"
             mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <converters:IsNullToVisibilityConverter x:Key="IsNullToVisibilityConverter" />
            <converters:IsNullToVisibilityConverter x:Key="InversedIsNullToVisibilityConverter"
                                                    IsInversed="True" />
            <converters:IsDisplayDetailConverter x:Key="IsDisplayDetailConverter" />
            <converters:IsDayModeToVisibilityConverter x:Key="IsDayModeToVisibilityConverter" />
            <converters:IsNightModeToVisibilityConverter x:Key="IsNightModeToVisibilityConverter" />
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <SplitView x:Name="HamburgerMenu"
                   PaneBackground="Transparent">
            <SplitView.Pane>
                <Grid>
                    <Image Source="/Assets/Images/hamburger_menu_background.jpg"
                           Stretch="UniformToFill">
                        <interactivity:Interaction.Behaviors>
                            <behaviors:Blur Value="5"
                                            Duration="0" />
                        </interactivity:Interaction.Behaviors>
                    </Image>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0"
                                        Visibility="{Binding Path=UserInfo, Converter={StaticResource IsNullToVisibilityConverter}}">
                                <Image Width="48"
                                       Height="48"
                                       Margin="0,12,0,0"
                                       Source="{Binding Path=UserInfo.Icon}" />
                                <TextBlock Margin="0,4,0,0"
                                           Foreground="#005737"
                                           Text="{Binding Path=UserInfo.Nickname}"
                                           TextAlignment="Center"
                                           Visibility="{Binding Path=UserInfo, Converter={StaticResource IsNullToVisibilityConverter}}" />
                                <localControls:HamburgerMenuItem x:Uid="/MainView/LogoutMenuItem"
                                                                 Height="48"
                                                                 HorizontalAlignment="Stretch"
                                                                 Command="{Binding Path=LogoutCommand}"
                                                                 Visibility="{Binding Path=UserInfo, Converter={StaticResource IsNullToVisibilityConverter}}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <FontIcon FontFamily="Segoe MDL2 Assets"
                                                  Glyph="&#xE8DE;" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                            </StackPanel>
                            <StackPanel Grid.Row="0"
                                        Visibility="{Binding Path=UserInfo, Converter={StaticResource InversedIsNullToVisibilityConverter}}">
                                <localControls:HamburgerMenuItem x:Uid="/MainView/LoginMenuItem"
                                                                 Height="48"
                                                                 HorizontalAlignment="Stretch"
                                                                 Command="{Binding Path=LoginCommand}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <SymbolIcon Symbol="Contact" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                            </StackPanel>
                            <StackPanel Grid.Row="2"
                                        Orientation="Vertical">
                                <localControls:HamburgerMenuItem x:Uid="/MainView/SwitchToDayModeMenuItem"
                                                                 Visibility="{Binding Source={StaticResource Locator}, Path=ThemeModeManager.CurrentTheme, Converter={StaticResource IsNightModeToVisibilityConverter}}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                            <core:ChangePropertyAction PropertyName="CurrentTheme"
                                                                       TargetObject="{Binding Source={StaticResource Locator}, Path=ThemeModeManager}">
                                                <core:ChangePropertyAction.Value>
                                                    <models:ThemeMode>Day</models:ThemeMode>
                                                </core:ChangePropertyAction.Value>
                                            </core:ChangePropertyAction>
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <fontAwesome:FontAwesomeIcon Symbol="SunOutline" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                                <localControls:HamburgerMenuItem x:Uid="/MainView/SwitchToNightModeMenuItem"
                                                                 Visibility="{Binding Source={StaticResource Locator}, Path=ThemeModeManager.CurrentTheme, Converter={StaticResource IsDayModeToVisibilityConverter}}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                            <core:ChangePropertyAction PropertyName="CurrentTheme"
                                                                       TargetObject="{Binding Source={StaticResource Locator}, Path=ThemeModeManager}">
                                                <core:ChangePropertyAction.Value>
                                                    <models:ThemeMode>Night</models:ThemeMode>
                                                </core:ChangePropertyAction.Value>
                                            </core:ChangePropertyAction>
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <fontAwesome:FontAwesomeIcon Symbol="MoonOutline" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                                <localControls:HamburgerMenuItem x:Uid="/MainView/PraiseMenuItem"
                                                                 Command="{Binding Path=PraiseCommand}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <FontIcon FontFamily="Segoe MDL2 Assets"
                                                  Glyph="&#xE006;" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                                <localControls:HamburgerMenuItem x:Uid="/MainView/SettingMenuItem"
                                                                 Command="{Binding Path=SettingCommand}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <SymbolIcon Symbol="Setting" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                                <localControls:HamburgerMenuItem x:Uid="/MainView/AboutMenuItem"
                                                                 Command="{Binding Path=AboutCommand}">
                                    <interactivity:Interaction.Behaviors>
                                        <core:EventTriggerBehavior EventName="Click">
                                            <core:ChangePropertyAction PropertyName="IsPaneOpen"
                                                                       TargetObject="{Binding ElementName=HamburgerMenu}"
                                                                       Value="False" />
                                        </core:EventTriggerBehavior>
                                    </interactivity:Interaction.Behaviors>
                                    <localControls:HamburgerMenuItem.Icon>
                                        <FontIcon FontFamily="Segoe MDL2 Assets"
                                                  Glyph="&#xE946;" />
                                    </localControls:HamburgerMenuItem.Icon>
                                </localControls:HamburgerMenuItem>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </SplitView.Pane>
            <localControls:MasterDetailView IsDisplayDetail="{Binding ElementName=DetailFrame, Path=Content, Converter={StaticResource IsDisplayDetailConverter}}"
                                            MasterPaneWidth="400">
                <localControls:MasterDetailView.MasterContent>
                    <Frame x:Name="MasterFrame"
                           SourcePageType="views:ArticleView" />
                </localControls:MasterDetailView.MasterContent>
                <localControls:MasterDetailView.Splitter>
                    <Grid Width="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="48" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0"
                                Background="{ThemeResource U148AccentBrush}" />
                        <Border Grid.Row="1"
                                Background="{ThemeResource U148DividerBrush}" />
                    </Grid>
                </localControls:MasterDetailView.Splitter>
                <localControls:MasterDetailView.DetailContent>
                    <Frame x:Name="DetailFrame"
                           SourcePageType="views:EmptyDetailView" />
                </localControls:MasterDetailView.DetailContent>
            </localControls:MasterDetailView>
        </SplitView>
    </Grid>
</UserControl>